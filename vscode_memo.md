# vscodeの使い方メモ

## ヒント

- 右クリックで`コンテキストメニュー`を出す
- サイドバーの右上の`...`ボタンを押す
- `上のメニュー`や`下のステータスバー`を見る
- `コマンドパレット`でそれっぽいキーワードで検索する

---

## .vscodeフォルダ

- `tasks.json`: タスク定義  
- `launch.json`: デバッグ構成
- `settings.json`: エディター設定

---

## エディター

> - 言語サーバー  
>       言語サーバーはインテリセンスや定義へのジャンプ、警告など、その`言語に関するサービスを提供`する  
>       様々な`エディター`が`クライアント`として`言語サーバー`と`言語サーバープロトコル`を介して`通信`する  
>       そうすることで様々なエディター間で柔軟に対応することができる仕組み  
>   - 型定義ファイル(@type/expressなど)  
>       各言語の`コンパイラ`や`vscode`に`パッケージやライブラリ`内の定義された型を教える  
>       そうすることで`インテリセンスが効く`ようになる  
>   - インテリセンス  
>       `"."による参照`や、`関数の仕様や引数`、`スペニット`、を行う  
>     - スペニット  
>           入力した文字列を含むワードを候補として出してくれる。予測変換のようなもの  
> - Emmet
> `h1*3`と書くと`h1タグ`が`3つ`できる  
> `入力した文字列`を`別の文字列`に`変換`して記述を省略して書ける

- エディターコンテキストメニュー  
  - `定義へ移動`: その`変数や関数`が`定義された場所`に移動
  - `型定義へ移動` その`変数や関数`の`型`が`定義された場所`に移動  
  - `参照をここに表示` その`オブジェクト`が`参照`されている全ての場所を表示  
  - `シンボルの名前変更` そのシンボル(識別子?)の名前を変える。(~~影響範囲はファイル内になる~~)
- `エラー、警告`は`ステータスバー`または`問題パネル`に表示される
- タブはドラッグで`移動`できる。別ウインドウで表示することは多分できない
- アクティブエディターの右上の`[|]ボタン`でエディターを`分割`できる
- Markdonwなどプレビュー可能なもの?は右上の`↑に似たボタン`で横に分割して`プレビューを表示`できる

---

## エクスプローラー

> `プロジェクト`は`フォルダ単位`または`ワークスペース`という複数のフォルダから作れる  
> プロジェクトを作ってもそのフォルダに`vscodeが勝手に何かファイルを生成することは無い`  
> とても、気軽に開ける  

- コンテキストメニュー`選択対象の選択`→`選択対象と比較`の比較ができる

---

## 検索

> `サイドバーの検索`は含めるファイル、除外するファイル を指定できる。  

- 検索: `Ctrl + F`
- 置換: `Ctrl + H`
- テキスト上で検索&置換: `Ctrl + D`(選択), `Ctrl + K`(選択スキップ)

---

## デバッグ

> デバッグを行うには`デバッガ`を`デバッグ構成に追加`をしなければならない  
> いくつかの`デバッガ`はあらかじめ組み込まれている  
> `デバッガ`は`拡張機能からインストール`できる(`言語サーバー`に付いてくる?)(`構成の追加`の`More...`からも)  
> `デバッグの構成`は`デバッガ`を`launch.json`に構成を定義すること  
> `デバッガ`は`実行開始時`または`実行中`の`プロセス`に`アタッチ`されるもの(`"request": "launch", "attach"`)  

多分、デバッグは`type(デバッガ)`を`request`に応じて`program`に`アタッチ`するイメージ  

launch.json

```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "type": "node", //(必須)使用するデバッガ。Node.jsではnode、Goではgoなど
            "request": "launch", //(必須)実行開始時= launch、実行中= attach(p121~p123)
            "name": "Launch Server", //(必須)デバッグする時に選択する構成の追加の部分に現れる名前
            "program": "${workspaceFolder}/dist/server.js", //実行するプログラム
            "preLaunchTask": "build", //デバッグを行う前に実行するvscodeのタスクを指定
            "outFiles":["${workspaceFolder}/dist/**/*.js"]
            //↑は生成されたJavaScriptファイルの位置をデバッガに教える
        },{}]}
```

### デバッグ中の操作

- デバッグアクション  
デバッグする時によく見られる`デバッグツールバー`  
  - `開始`、`一時停止`、`再開`、`停止`、`再起動`、`ステップオーバー`、`ステップイン`、`ステップアウト`  
- ブレークポイント  
`行番号の左側`を`クリック`するだけ  
- 変数  
`現在のスコープ`にある`変数の値`を確認できる
- ウォッチ式  
`現在のスコープ`にある`変数の値`から式を作って確認?
- コールスタック  
`関数呼び出し`の`スタック`を見れる

---

## タスク

> タスクは`シェルや各種CLIツール`と`連携`して、さまざまな`コマンド`を`キーボードショートカット?`から実行できるようにするものです。

- ↓の`tasks.json`は`ターミナル`で`npm run build`を実行するタスク(`run`が現れない)  
多分、`タスク機能`は`ターミナル`で`[> type script]`または`[> type command args]`を実行するイメージ?

tasks.json  

```json
{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "build", //タスクを呼ぶ際に使用される名前
            "type": "npm", //タスクの種類"shell""process""gulp"など
            "script": "build",//"type": "npm"の時、npmスクリプト名を指定
            "group": { //ビルドやテストなどの分類や、デフォルトタスクを指定
                "kind": "build",
                "isDefault": true
            },
            "problemMatcher": [ //タスクの出力結果を解釈して、問題パネルやエディター内に
                "$tsc"          //エラーや警告として表示する機能(p108,p109参照)
            ]   //↑のように出力を解釈するパーサはいくつかデフォルトで組み込まれていて、
        },{}]}  //「$tsc」のほかに「$jshint」や「$go」などがある
```

- タスクの自動認識  
  - p104, p105の操作を行うと`package.json(npm)`から↑の`tasks.json`が作成されタスクが定義される
  - `typeScript(tsconfig.json)`、`npm(package.json)`、などの定義されたシェルコマンドを  
    vscodeは自動認識してvscodeのタスクとして↑の`tasks.json`のように定義できる  

---

## タスクとデバッガの設定ファイル(tasks.json, launch.json)で使用できる変数

- 主にプログラムのパスを指定するために使用される  
p126~p128参照(読めば分かる)  

---

## Git

- [Visual Studio Code入門 #07：Gitクライアントはもういらない！ VSCodeで、Gitを使いこなそう](https://www.youtube.com/watch?v=vMZ0C06soxA)  
- git_memo参照  

---

## 拡張機能

> `Node.js`の`npm`から`Yeoman`という`vscode公式が提供するパッケージ?`を`インストール`をして拡張機能に  
> 必要なファイルを生成します。  
> `package.json`はユーザーの`入力を受け取り`vscodeに伝える  
> `extension.ts`は拡張機能を実現する為の`処理を実行`する

1. `コマンドパレット`から`categorey`で検索、`title`を見つけ選択すると
2. `command`が`実行するがその前`に
3. `activationEvents`の`onCommand`に`そのcommandが登録`されているので
4. `activateメソッドを実行`し`registerCommand実行`して`commandID`と`その対応する処理`を登録する
5. `command`に`対応するcommandID`を見つけ`その対応する処理`を`実行`する

package.json

```json
{
    "activationEvents": [ //拡張機能を登録するタイミングを定義する
        "onCommand:my.merryMilk" //←のコマンドを実行した時
                                //↓↓のactivateメソッドを実行して処理を登録する
    ],
    "contributes": { //どの機能をどのように拡張するか定義する
        "commands": [ //コマンドパレットの機能を拡張する
            {
                "command": "my.merryMilk", //選択された時に実行されるコマンド
                "category": "なんやおら", //categoryとtitleはコマンドパレットから選択される
                "title": "大国"
            },{}]}}
```

extension.ts

```ts
export function activate(context: vscode.ExtensionContext) {//処理を登録する処理
    let disposable = vscode.commands.registerCommand('my.merryMilk', () => {
            //commandIDと処理を登録する↑
        vscode.window.showWarningMessage('ひつじさん！ひつじ酸！', 'いきやす', '波動拳！')
    });
}
```

> `context`は今回は特に`使っていない`。`vscodeオブジェクト`を使って`API操作`している  
> 拡張機能のエディターの`コントリビューション`タブは`package.json`の`"contributes"`と一致する  
> `package.json`の`設定項目`: p251, 公開とパッケージ配布:p254~260  

### 咲来たんオススメの拡張機能

p220~p236参照

---

## 設定エディター

> `設定エディター`とは`Ctrl + ,`で開ける`エディター`  
> `設定エディター`にある項目は`vscodeに関するの全ての基本設定`である  
> その`基本設定`は`settings.json`に全て書かれている  
> `settings.json`は`フォルダー`、`ワークスペース`、`ユーザー`、`デフォルト`に`存在できる`  
> それと、`ある言語`にしか`適用`されない`言語固有`の`設定も定義`できる。`優先度も高い`  
> `各、設定ファイル`や`言語固有`の間に`優先度`があり`低優先度`は`高優先度`に`オーバーライド`される  
> それは`↓の順`に`オーバーライド`される(オーバーライド: する＞される)  
> 言語固有フォルダー＞言語固有ワークスペース＞言語固有ユーザー＞言語固有デフォルト＞  
> フォルダー＞ワークスペース＞ユーザー＞デフォルト  
> それらの`settigs.json`の保存場所は  
> `フォルダー`: そのフォルダの`.vscodeフォルダの中`  
> `ワークスペース`: ワークスペースを定義する`{ワークスペース名}.code-workspace`(settigns.jsonじゃない)  
> `ユーザー`: C:\Users\asreia\AppData\Roaming\Code\User\\`settings.json`  
> `デフォルト`: コマンドパレット`[>default settings json]` (多分vscode内の`組み込み?`(読み取り専用))  

- `デフォルトの言語固有`に`オーバーライド`されてしまうので`コーディングに関する設定`は基本的に`言語固有で設定`した方がいいらしい

言語固有の設定。ユーザーsettings.json  

```json
"[yaml]": {
    "editor.tabSize": 4
}
```

### 主要なカスタマイズ項目 ～ キーボードショートカット・入力系のカスタマイズ  

- p167~p182を参照  

### ユーザースニペットの定義

- スニペットはユーザー、フォルダ、ワークスペースに書ける(多分)
- 拡張子は.code-snippets

testsp.code-snippets

```json
{
    "Print to console": {
        "scope": "javascript,typescript", //このスペニットを使える言語を指定
        "prefix": "log", //インテリセンスを効かせたい単語
        "body": [ //prefixがbodyに置き換わる
            "console.log('$1');", //"$1"の所にカーソルが現れ[Tabキー]で次の"$2"に移動する
            "$2"
        ],
        "description": "Log output to console" //インテリセンスで候補が出てきた時に出てくる説明
    }
}
```

### 設定ファイルと拡張機能の保存場所

- ↓`ユーザーsettings.json`があった`C:\Users\asreia\AppData\Roaming\Code\User`にある設定ファイル  

| 設定ファイル名     | 用途                           |
| :----------------- | :----------------------------- |
| `keybindings.json` | キーボードショートカットの設定 |
| `locale.json`      | 言語設定                       |
| `settings.json`    | ユーザーsettings.json          |
| `snippets/**.json` | 各言語用のスペニットファイル   |

- `拡張機能`の`保存場所`  
C:\Users\asreia\.vscode\extensions

---

## コマンドパレット、クイックオープン、行移動

- `Ctrl + Shift + P`: コマンドパレット(登録してあるコマンドをターミナルで実行する?task?)
  - `git`: Gitコマンド
  - `debug`: デバック操作
- `Ctrl + P`: クイックオープン(ファイルを検索して開く(`→`キーで開ける))
  - `?`:使い方?が出る
  - `@`: ファイル内シンボルへ移動
  - `#`: ワークスペース内シンボルへ移動
- `Ctrl + G`: 行と列を指定してカーソル移動(:6:10)

---

## ショートカット

### 表示系

| キー                | 動作                                         |
| :------------------ | :------------------------------------------- |
| ★`Ctrl + Tab`       | エディターグループ内の直前のエディターに移動 |
| ★`Ctrl + Shift + T` | 閉じたエディターを開く                       |
| ★`Ctrl + Shift + P` | コマンドパレット表示                         |
| `Ctrl + P`          | クイックオープン                             |
| `Ctrl + B`          | サイドバー表示                               |
| `Ctrl + J`          | 下のパネル表示                               |
| `Ctrl + ,`          | 設定エディター表示                           |
| `F11`               | フルスクリーンのトグル                       |

### 操作系

| キー        | 動作               |
| :---------- | :----------------- |
| ★`Ctrl + S` | 保存               |
| `Ctrl + N`  | 新規ファイルを開く |
| `Ctrl + O`  | ファイルを開く     |
| `F5`        | デバック開始/続行  |
 
### エディタ系

| キー                           | 動作                                                   |
| :----------------------------- | :----------------------------------------------------- |
| 一行処理                       |
| ★`Ctrl + Enter`                | 下に行を追加して移動                                   |
| ★`Ctrl + C,X`                  | 選択状態で無くてもその行をコピー,切り取り              |
| ★`Ctrl + L`                    | 現在の行を選択、既に選択がある場合は選択の行を全て選択 |
| ★`Alt + ↑/↓`                   | 行や選択を上下に移動                                   |
| ★`Ctrl + /`                    | コメントアウト トグル                                  |
| マルチカーソル、検索           |
| ★`Ctrl + D`                    | 次の検索マッチを選択に追加                             |
| ★`Ctrl + K, Ctrl + D`          | ↑のスキップ                                            |
| `Ctrl + F`                     | 検索                                                   |
| `Ctrl + H`                     | 置換                                                   |
| `Alt + Click`                  | カーソルのクリック追加                                 |
| `Ctrl + Alt + ↑/↓`             | カーソルの上下追加                                     |
| ファイル全体処理               |
| `Shift + Alt + F`              | ファイル全体をフォーマット                             |
| `F2`                           | シンボル名変更(影響範囲が別ファイルに広がる事がある)   |
| カーソル移動                   |
| ★`Ctrl + Shift + O`            | ファイル内のシンボルへ移動                             |
| `Ctrl + T`                     | ワークスペース内のシンボルへ移動                       |
| ★`Ctrl + ←/→`                  | 単語単位でカーソル移動                                 |
| ★`Alt + ←/→`                   | カーソルとエディターのアンドゥ、リドゥ                 |
| `Ctrl + U`                     | カーソルのアンドゥ                                     |
| `Ctrl + G`                     | 指定行へ移動                                           |
| `F8`                           | 次のエラーか警告に移動                                 |
| 表示                           |
| `Alt + Z`                      | 折返しのトグル                                         |
| `Ctrl + Space`                 | スペニットを表示                                       |
| `Crrl + Shift + Space`         | 関数の仕様と引数を表示                                 |
| 特殊処理                       |
| ★`Alt + スクロール`            | スクロール速度５倍                                     |
| ★`Ctrl + 左クリック`           | あらゆるリンク先へ飛ぶ(無かったら作る)                 |
| `Shift + Alt + マウスドラッグ` | 矩形選択                                               |
| `Ctrl + .`                     | クイックフィックス                                     |

---

## 考察とその他

- `vscodeはTypeScriptで作られている。`ヘルプの開発者ツールはchromeのやつ  
    vscodeはブラウザが動けば動く?  
    [Electronらしい (ヘルプ:バージョン情報より)](https://qiita.com/umamichi/items/6ce4f46c1458e89c4cfc)  
- ヘルプの`プロセスエクスプローラ`と言うのがありタスクマネージャーのようなものが開く  
- `ブレークポイントの種類`が色々(デバック:新しいブレークポイント)  
- ファイルから`ファイルを元に戻`すがある  
- ファイル:基本設定:`ユーザースペニット`  
- エディター右上の分割[|]の左側に`gitの差分`を見れる

---
