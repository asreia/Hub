(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2004],{91192:function(e,n,t){Promise.resolve().then(t.bind(t,54710))},54710:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return o}});var r=t(27573),i=t(71817);function o(e){let{children:n}=e;return(0,r.jsx)(i.hH,{children:n})}},25449:function(e){e.exports=function(e,n,t){return e==e&&(void 0!==t&&(e=e<=t?e:t),void 0!==n&&(e=e>=n?e:n)),e}},79884:function(e,n,t){var r=t(15428),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},15428:function(e){var n=/\s/;e.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},52221:function(e,n,t){var r=t(25449),i=t(97172);e.exports=function(e,n,t){return void 0===t&&(t=n,n=void 0),void 0!==t&&(t=(t=i(t))==t?t:0),void 0!==n&&(n=(n=i(n))==n?n:0),r(i(e),n,t)}},87590:function(e,n,t){var r=t(62579);e.exports=function(e,n){return r(e,n)}},97172:function(e,n,t){var r=t(79884),i=t(88873),o=t(58510),a=0/0,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return a;if(i(e)){var n="function"==typeof e.valueOf?e.valueOf():e;e=i(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var t=l.test(e);return t||u.test(e)?c(e.slice(2),t?2:8):s.test(e)?a:+e}},88146:function(e,n,t){"use strict";t.d(n,{default:function(){return i.a}});var r=t(16340),i=t.n(r)},79939:function(e){!function(){"use strict";var n={114:function(e){function n(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function t(e,n){for(var t,r="",i=0,o=-1,a=0,s=0;s<=e.length;++s){if(s<e.length)t=e.charCodeAt(s);else if(47===t)break;else t=47;if(47===t){if(o===s-1||1===a);else if(o!==s-1&&2===a){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2)){if(r.length>2){var l=r.lastIndexOf("/");if(l!==r.length-1){-1===l?(r="",i=0):i=(r=r.slice(0,l)).length-1-r.lastIndexOf("/"),o=s,a=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=s,a=0;continue}}n&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,s):r=e.slice(o+1,s),i=s-o-1;o=s,a=0}else 46===t&&-1!==a?++a:a=-1}return r}var r={resolve:function(){for(var e,r,i="",o=!1,a=arguments.length-1;a>=-1&&!o;a--)a>=0?r=arguments[a]:(void 0===e&&(e=""),r=e),n(r),0!==r.length&&(i=r+"/"+i,o=47===r.charCodeAt(0));return(i=t(i,!o),o)?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(n(e),0===e.length)return".";var r=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return(0!==(e=t(e,!r)).length||r||(e="."),e.length>0&&i&&(e+="/"),r)?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0==arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];n(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t||(e=r.resolve(e))===(t=r.resolve(t)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var o=e.length,a=o-i,s=1;s<t.length&&47===t.charCodeAt(s);++s);for(var l=t.length-s,u=a<l?a:l,c=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(47===t.charCodeAt(s+d))return t.slice(s+d+1);if(0===d)return t.slice(s+d)}else a>u&&(47===e.charCodeAt(i+d)?c=d:0===d&&(c=0));break}var v=e.charCodeAt(i+d);if(v!==t.charCodeAt(s+d))break;47===v&&(c=d)}var g="";for(d=i+c+1;d<=o;++d)(d===o||47===e.charCodeAt(d))&&(0===g.length?g+="..":g+="/..");return g.length>0?g+t.slice(s+c):(s+=c,47===t.charCodeAt(s)&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,i=-1,o=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!o){i=a;break}}else o=!1;return -1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw TypeError('"ext" argument must be a string');n(e);var r,i=0,o=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,l=-1;for(r=e.length-1;r>=0;--r){var u=e.charCodeAt(r);if(47===u){if(!a){i=r+1;break}}else -1===l&&(a=!1,l=r+1),s>=0&&(u===t.charCodeAt(s)?-1==--s&&(o=r):(s=-1,o=l))}return i===o?o=l:-1===o&&(o=e.length),e.slice(i,o)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){i=r+1;break}}else -1===o&&(a=!1,o=r+1);return -1===o?"":e.slice(i,o)},extname:function(e){n(e);for(var t=-1,r=0,i=-1,o=!0,a=0,s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(47===l){if(!o){r=s+1;break}continue}-1===i&&(o=!1,i=s+1),46===l?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1)}return -1===t||-1===i||0===a||1===a&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){var n,t;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return n=e.dir||e.root,t=e.base||(e.name||"")+(e.ext||""),n?n===e.root?n+t:n+"/"+t:t},parse:function(e){n(e);var t,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var i=e.charCodeAt(0),o=47===i;o?(r.root="/",t=1):t=0;for(var a=-1,s=0,l=-1,u=!0,c=e.length-1,d=0;c>=t;--c){if(47===(i=e.charCodeAt(c))){if(!u){s=c+1;break}continue}-1===l&&(u=!1,l=c+1),46===i?-1===a?a=c:1!==d&&(d=1):-1!==a&&(d=-1)}return -1===a||-1===l||0===d||1===d&&a===l-1&&a===s+1?-1!==l&&(0===s&&o?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(s,l)):(0===s&&o?(r.name=e.slice(1,a),r.base=e.slice(1,l)):(r.name=e.slice(s,a),r.base=e.slice(s,l)),r.ext=e.slice(a,l)),s>0?r.dir=e.slice(0,s-1):o&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r}},t={};function r(e){var i=t[e];if(void 0!==i)return i.exports;var o=t[e]={exports:{}},a=!0;try{n[e](o,o.exports,r),a=!1}finally{a&&delete t[e]}return o.exports}r.ab="//";var i=r(114);e.exports=i}()},28803:function(e,n,t){"use strict";t.d(n,{V0:function(){return k},bf:function(){return C},OD:function(){return B},m:function(){return x},$Y:function(){return I},$H:function(){return O},j1:function(){return P},f7:function(){return z},Pe:function(){return E},j7:function(){return L},Rq:function(){return b},Cy:function(){return R},cE:function(){return y},CJ:function(){return A},_C:function(){return S},QR:function(){return w},y6:function(){return j},cc:function(){return T},gm:function(){return U},Ke:function(){return q},T$:function(){return V},fc:function(){return H},W:function(){return K},PD:function(){return D},Gk:function(){return $},gK:function(){return N},Ls:function(){return Q},jl:function(){return F}});var r=t(3053),i=t(5362),o=t(27218),a=t(1812),s=t(98731),l=t(13262),u=t(7653);function c(e){let n=JSON.stringify(e);return(0,u.useMemo)(()=>e,[n])}var d=t(51432),v=t(45144),g=t(77930),_=t(50803),f=t(87590),p=t.n(f),m=t(81695),h=t(1146);let b=e=>{let n=(0,g.useQueryClient)(),{activeOrganization:t}=(0,o.t)(),r=null==t?void 0:t.uuid,[i,a]=(0,u.useReducer)(e=>e+1,0),s=c([l.I8,{orgUUID:r},{uuid:e}]),d=(0,u.useMemo)(()=>n.getQueryData(s),[n,s,e,i]);return(0,u.useEffect)(()=>n.getQueryCache().subscribe(e=>{"updated"===e.type&&"success"===e.action.type&&(0,_._x)({queryKey:s},e.query)&&a()}),[n,a,s]),{data:d}},y=e=>{let n=(0,g.useQueryClient)(),{activeOrganization:t}=(0,o.t)(),r=null==t?void 0:t.uuid,i=c([l.I8,{orgUUID:r},{uuid:e}]);return n.getQueryData(i)},k=30,C=1e4,w=e=>{let{limit:n,offset:t,enabled:r=!0,starred:a}=e,{activeOrganization:s}=(0,o.t)(),u=null==s?void 0:s.uuid,c=new URLSearchParams;void 0!==n&&c.append("limit",n.toString()),void 0!==t&&c.append("offset",t.toString()),void 0!==a&&c.append("starred",a.toString());let d=c.toString();return d=d?"?".concat(d):"",(0,i.WE)("/api/organizations/".concat(null!=u?u:"","/chat_conversations").concat(d),{queryKey:[l.tv,{orgUUID:u},{limit:n,offset:t,starred:a}],staleTime:3e5,enabled:!!u&&r})},x=()=>{let{activeOrganization:e}=(0,o.t)(),n=null==e?void 0:e.uuid;return(0,i.WE)("/api/organizations/".concat(n,"/chat_conversations/count_all"),{queryKey:[l.Dn,{orgUUID:n}],staleTime:3e5,enabled:!!n})},E=()=>{let{activeOrganization:e}=(0,o.t)(),n=(0,i.OJ)();return(0,u.useCallback)(async t=>{let{limit:r,offset:i}=t,o=new URLSearchParams;void 0!==r&&o.append("limit",r.toString()),void 0!==i&&o.append("offset",i.toString());let a=o.toString();return a=a?"?".concat(a):"",(await n("/api/organizations/".concat(null==e?void 0:e.uuid,"/chat_conversations").concat(a))).json()},[null==e?void 0:e.uuid,n])},S=function(e){let{suppressError:n,enabled:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},{activeOrganization:r}=(0,o.t)(),a=null==r?void 0:r.uuid,s=(0,u.useRef)([]),c=(0,g.useQueryClient)(),d="/api/organizations/".concat(null!=a?a:"","/chat_conversations/").concat(e,"?tree=True&rendering_mode=messages&render_all_tools=true"),v=(0,i.WE)(d,{queryKey:[l.I8,{orgUUID:a},{uuid:e}],staleTime:3e5,enabled:!!a&&!!e&&t,meta:{noToast:n}},n=>(c.invalidateQueries({queryKey:[l.Gj,{orgUUID:a,conversationUUID:e}]}),(0,h.fX)(n))),_=(0,u.useMemo)(()=>{if(!v.data)return s.current=[],s.current;let e=(0,h.kX)(v.data);if(e.length!==s.current.length||e.some((e,n)=>{var t;return e.uuid!==(null===(t=s.current[n])||void 0===t?void 0:t.uuid)}))return s.current=e,s.current;for(let n=0;n<e.length;n++)p()(e[n],s.current[n])||(s.current[n]=e[n]);return s.current},[v.data]);return{...v,currentPath:_}},T=e=>{let n=(0,g.useQueryClient)(),{activeOrganization:t}=(0,o.t)(),r=null==t?void 0:t.uuid;return(0,u.useCallback)(()=>{n.invalidateQueries({queryKey:[l.I8,{orgUUID:r},{uuid:e}]})},[n,r,e])},O=(e,n)=>{let{mutateAsync:t}=I(),r=(0,m.useRouter)(),i=n||(0,d.H)();return(0,u.useCallback)(function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:void 0,controlsOpen:!1},o={uuid:i,name:"",model:n.model};n.createMode&&(o.create_mode=n.createMode),n.projectUuid&&(o.project_uuid=n.projectUuid),t(o).then(()=>{let t="/chat/".concat(i).concat(n.controlsOpen?"?controls=1":"");r[e](t)}).catch(e=>{(0,v.Tb)(e)})},[t,r,e,i])},I=()=>{let{activeOrganization:e}=(0,o.t)(),n=null==e?void 0:e.uuid,t=(0,g.useQueryClient)(),r=e=>[l.I8,{orgUUID:n},{uuid:e}];return(0,i.uC)("/api/organizations/".concat(null!=n?n:"","/chat_conversations"),"POST",{enabled:!!n,onSuccess:e=>{t.setQueryData(r(e.uuid),n=>({...n||{},...e,chat_messages:(null==n?void 0:n.chat_messages)||[],messageByUuid:new Map,parentByChildUuid:new Map,childrenByParentUuid:new Map,selectedChildByUuid:new Map}))}})},P=()=>{let{activeOrganization:e}=(0,o.t)(),n=null==e?void 0:e.uuid,t=(0,g.useQueryClient)();return(0,i.Ne)(e=>{let{uuid:t}=e;return"/api/organizations/".concat(null!=n?n:"","/chat_conversations/").concat(t)},"DELETE",(e,n)=>{let{uuid:t}=e;if(!n)return[];let r=n.findIndex(e=>e.uuid===t);if(!(r>-1))return n;{let e=[...n];return e.splice(r,1),e}},{enabled:!!n,queryKey:[l.tv,{orgUUID:n}],onSuccess:async(e,r)=>{let{uuid:i,projectUuid:o}=r;await t.invalidateQueries({queryKey:[l.I8,{orgUUID:n},{uuid:i}]}),o&&await t.invalidateQueries({queryKey:[l.lx,{orgUuid:n,projectUuid:o}]}),await W(t,n)}})},z=e=>{let{activeOrganization:n}=(0,o.t)(),t=null==n?void 0:n.uuid,r=(0,g.useQueryClient)();return(0,i.uC)("/api/organizations/".concat(t,"/chat_conversations/delete_many"),"POST",{onSuccess:async n=>{await W(r,t),e&&e(n)}})},U=()=>{let{activeOrganization:e}=(0,o.t)(),n=null==e?void 0:e.uuid,t=null==e?void 0:e.capabilities.includes("raven");return(0,i.WE)("/api/organizations/".concat(n,"/shares"),{queryKey:[l.PB,{orgUUID:n}],enabled:!!n&&t,staleTime:3e5})},R=e=>{let{activeOrganization:n}=(0,o.t)(),t=null==n?void 0:n.uuid;return(0,i.WE)("/api/organizations/".concat(t,"/chat_conversations/").concat(e,"/latest"),{enabled:!!t&&!!e,queryKey:[l.Gj,{orgUUID:t,conversationUUID:e}],staleTime:0,meta:{noToast:!0}},e=>{let{snapshot:n,shareable:t,disabled_reason:r}=e;return{shareable:t,disabled_reason:r,snapshot:n?{...n,chat_messages:n.chat_messages.map(e=>(0,h.Dk)(e))}:null}})},A=e=>{let{activeOrganization:n,account:t}=(0,o.t)(),r=null==n?void 0:n.uuid,a=t&&r?"/api/organizations/".concat(r,"/chat_snapshots/").concat(e,"?rendering_mode=messages&render_all_tools=true"):"/api/chat_snapshots/".concat(e,"?rendering_mode=messages&render_all_tools=true");return(0,i.WE)(a,{retry:!1,refetchInterval:!1,enabled:!!e,staleTime:0,queryKey:[l.ld,{orgUUID:r,snapshotUUID:e}]},e=>({...e,chat_messages:e.chat_messages.map(e=>(0,h.Dk)(e))}))},D=e=>{let{activeOrganization:n}=(0,o.t)(),t=null==n?void 0:n.uuid,r=(0,g.useQueryClient)();return(0,i.uC)("/api/organizations/".concat(t,"/chat_conversations/").concat(e,"/share"),"POST",{onSuccess:()=>{r.invalidateQueries({queryKey:[l.Gj,{orgUUID:t,conversationUUID:e}]}),r.invalidateQueries({queryKey:[l.PB,{orgUUID:t}]}),r.invalidateQueries({queryKey:[l.VH,{orgUUID:t}]})}})},Q=(e,n)=>{let{activeOrganization:t}=(0,o.t)(),r=null==t?void 0:t.uuid,a=(0,g.useQueryClient)();return(0,i.uC)("/api/organizations/".concat(r,"/share/").concat(n),"DELETE",{enabled:!!r&&!!n,meta:{errorMessage:"There was an error while trying to unshare the conversation. Please try again."},onSuccess:()=>{a.invalidateQueries({queryKey:[l.Gj,{orgUUID:r,conversationUUID:e}]}),a.invalidateQueries({queryKey:[l.PB,{orgUUID:r}]}),a.invalidateQueries({queryKey:[l.VH,{orgUUID:r}]})}})},j=e=>{let{activeOrganization:n}=(0,o.t)(),t=null==n?void 0:n.uuid;return(0,i.WE)("/api/organizations/".concat(t,"/artifact-versions/").concat(e),{retry:!1,refetchInterval:!1,enabled:!!e&&!!t,staleTime:0,queryKey:[l.qB,{artifactVersionUUID:e}]})},q=function(e,n,t){var s,u,c;let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{track:v}=(0,r.z$)(),_=null!==(u=null===(s=(0,a.T)())||void 0===s?void 0:s.preview_feature_uses_artifacts)&&void 0!==u&&u,{activeOrganization:f}=(0,o.t)(),p=null==f?void 0:f.uuid,m=(0,g.useQueryClient)(),h=[l.I8,{orgUUID:p},{uuid:e}];return(0,i.uC)("/api/organizations/".concat(null!=p?p:"","/chat_conversations/").concat(e,"/chat_messages/").concat(null!==(c=n.uuid)&&void 0!==c?c:"","/chat_feedback"),n.chat_feedback?"PUT":"POST",{enabled:!!p,meta:{errorMessage:"We could not save your feedback. Please try again later."},...d,onSuccess(){for(var r,i,o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];v({event_key:"claudeai.conversation.feedback.sent",message_uuid:n.uuid,conversation_uuid:e,artifacts_enabled:_,conversationHasArtifacts:t,type:null===(r=n.chat_feedback)||void 0===r?void 0:r.type}),m.invalidateQueries({queryKey:h}),null===(i=d.onSuccess)||void 0===i||i.call(d,...a)}})},M=()=>{let e=(0,g.useQueryClient)(),{activeOrganization:n}=(0,o.t)(),t=null==n?void 0:n.uuid;return(0,u.useCallback)((n,r)=>{n&&(e.setQueryData([l.I8,{orgUUID:t},{uuid:n}],e=>e&&{...e,...r}),e.setQueriesData({queryKey:[l.tv,{orgUUID:t}]},e=>null==e?void 0:e.map(e=>e.uuid!==n?e:{...e,...r})))},[t,e])},K=e=>{let n=(0,g.useQueryClient)(),{activeOrganization:t}=(0,o.t)(),r=null==t?void 0:t.uuid,a=M();return(0,i.uC)("/api/organizations/".concat(r,"/chat_conversations/").concat(e),"PUT",{onMutate:t=>{var i;let{name:o}=t,s=n.getQueryData([l.I8,{orgUUID:r},{uuid:e}]);return a(e,{name:o}),{oldTitle:null!==(i=null==s?void 0:s.name)&&void 0!==i?i:""}},onError(n,t,r){r&&a(e,{name:r.oldTitle})}})},L=e=>{let n=M(),{activeOrganization:t}=(0,o.t)();return(0,i.uC)("/api/organizations/".concat(null==t?void 0:t.uuid,"/chat_conversations/").concat(e,"/title"),"POST",{onSuccess(t){let{title:r}=t;n(e,{name:null!=r?r:""})},meta:{noToast:!0}})};function B(e){var n,t;let r=(0,s.K)(e);return r+" "+e.attachments.map(e=>e.extracted_content).join(" ")+" "+((null===(n=e.content)||void 0===n?void 0:n.filter(e=>"tool_use"===e.type).map(e=>e.input?JSON.stringify(e.input):e.partial_json||"").join(" "))||"")+" "+((null===(t=e.content)||void 0===t?void 0:t.filter(e=>"tool_result"===e.type).flatMap(e=>e.content.filter(e=>"text"===e.type).map(e=>e.text)).join(" "))||"")}let N=e=>{let{activeOrganization:n}=(0,o.t)(),t=null==n?void 0:n.uuid;return(0,i.uC)("/api/organizations/".concat(t,"/chat_conversations/").concat(e,"/stop_response"),"POST")},H=()=>{let{activeOrganization:e}=(0,o.t)(),n=null==e?void 0:e.uuid;return(0,i.uC)(e=>{let{conversation_uuid:t}=e;return"/api/organizations/".concat(n,"/chat_conversations/").concat(t,"/tool_result")},"POST",{enabled:!!n,meta:{errorMessage:"We could not record the tool result. Please try again later."},transformVariables:e=>{let{conversation_uuid:n,...t}=e;return t}})},F=e=>{let{activeOrganization:n}=(0,o.t)(),t=null==n?void 0:n.uuid;return(0,i.uC)("/api/organizations/".concat(t,"/chat_conversations/").concat(e,"/current_leaf_message_uuid"),"PUT")},V=(e,n)=>{let{activeOrganization:t}=(0,o.t)(),r=(0,g.useQueryClient)(),a=null==t?void 0:t.uuid;return(0,i.Ne)("/api/organizations/".concat(a,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,n)=>n?{...n,settings:{...n.settings,...e.settings}}:void 0,{enabled:!!e,onSuccess:()=>{W(r,a)},onSettled:()=>{(null==n?void 0:n.refetchOnSettled)&&r.refetchQueries({queryKey:[l.I8,{orgUUID:a},{uuid:e}]})},queryKey:[l.I8,{orgUUID:a},{uuid:e}]})},W=async(e,n)=>{await Promise.all([e.invalidateQueries({queryKey:[l.tv,{orgUUID:n}]}),e.invalidateQueries({queryKey:[l.Dn,{orgUUID:n}]})])},$=e=>{let{activeOrganization:n}=(0,o.t)(),t=(0,g.useQueryClient)(),r=null==n?void 0:n.uuid;return(0,i.Ne)("/api/organizations/".concat(r,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,n)=>n?{...n,...e}:void 0,{onSuccess:()=>{W(t,r)},queryKey:[l.I8,{orgUUID:r},{uuid:e}]})}},1146:function(e,n,t){"use strict";t.d(n,{Dk:function(){return v},Ef:function(){return u},FC:function(){return a},Gg:function(){return c},HX:function(){return f},QC:function(){return l},fX:function(){return _},kX:function(){return m},mj:function(){return h},vv:function(){return p},w$:function(){return d},wZ:function(){return s}});var r=t(45144),i=t(52221),o=t.n(i);let a="new-assistant-message-uuid",s="new-human-message-uuid",l="00000000-0000-4000-8000-000000000000",u=e=>e!==a;function c(e,n){let t=e.get(n);if(void 0===t){let e=Error("Key not found: ".concat(n));throw(0,r.Tb)(e),e}return t}let d=(e,n)=>{let t=null!=n?n:e.current_leaf_message_uuid;if(!t)return e;for(;t!==l;){var r;let n=c(e.parentByChildUuid,t),i=null===(r=c(e.childrenByParentUuid,n))||void 0===r?void 0:r.indexOf(t);e.selectedChildByUuid.set(n,i),t=n}return{...e,current_leaf_message_uuid:n}},v=e=>e.content?e:{...e,content:[{type:"text",text:e.text||"",citations:[]}]},g=e=>{var n,t,r;let i=new Map,o=new Map,a=new Map,s=new Map,u=new Map;if(0===e.chat_messages.length)return{messageByUuid:o,parentByChildUuid:a,childrenByParentUuid:s,selectedChildByUuid:u};let c=e.chat_messages.map(v);for(let e of c)i.set(e.index,e),o.set(e.uuid,e);for(let e of c){let n=e.parent_message_uuid;if(!n){let r=e.index-1;for(;!n&&r>=0;)n=null===(t=i.get(r))||void 0===t?void 0:t.uuid,r--}n=null!=n?n:l,a.set(e.uuid,n),s.set(n,(null!==(r=s.get(n))&&void 0!==r?r:[]).concat(e.uuid)),u.set(n,0)}if(!(null===(n=s.get(l))||void 0===n?void 0:n[0]))throw Error("No root message found");return{chat_messages:c,messageByUuid:o,parentByChildUuid:a,childrenByParentUuid:s,selectedChildByUuid:u}},_=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=new Set;for(let n of e.chat_messages)"assistant"===n.sender&&n.parent_message_uuid&&t.add(n.parent_message_uuid);let r=e.chat_messages.filter(e=>"assistant"===e.sender||t.has(e.uuid)||void 0===e.parent_message_uuid||n),i={...e,chat_messages:r},o={...i,...g(i)};return o.current_leaf_message_uuid||d(o),d(o,i.current_leaf_message_uuid)},f=e=>{let n=Array.from(e.messageByUuid.values()).map(e=>e.index);return 0===n.length?-1:Math.max(...n)},p=(e,n)=>{for(let r of(e.chat_messages=e.chat_messages.concat(n),n)){var t;if(!r.parent_message_uuid)throw Error("Parent UUID required");let n=r.parent_message_uuid;e.messageByUuid.set(r.uuid,r),e.parentByChildUuid.set(r.uuid,n);let i=null!==(t=e.childrenByParentUuid.get(n))&&void 0!==t?t:[];i.push(r.uuid),e.childrenByParentUuid.set(n,i),e.selectedChildByUuid.set(n,i.length-1)}return d(e,n[n.length-1].uuid)},m=(e,n)=>{let t=[],r=null!=n?n:l;for(;e.childrenByParentUuid.has(r);){let n=c(e.childrenByParentUuid,r);if(0===n.length)break;let i=c(e.selectedChildByUuid,r),o=c(e.messageByUuid,n[i]);t.push({...o,parent_message_uuid:r,nOptions:n.length,selectedOption:i}),r=o.uuid}return t};function h(e,n,t){var r;let i=c(e.parentByChildUuid,n.uuid),a=c(e.childrenByParentUuid,i),s=o()((null!==(r=n.selectedOption)&&void 0!==r?r:0)+t,0,a.length-1);e.selectedChildByUuid.set(i,s);let l=m(e,i);return d(e,l[l.length-1].uuid)}},80573:function(e,n,t){"use strict";t.d(n,{$:function(){return i}});var r=t(87033);let i=()=>{let{value:e}=(0,r.FL)("claude_ai_segment_enabled");return e}},3053:function(e,n,t){"use strict";t.d(n,{YZ:function(){return h},q$:function(){return b},z$:function(){return m}});var r=t(30947),i=t(6385),o=t(87033),a=t(99586),s=t(7653),l=t(80573),u=t(5362),c=t(8571),d=t(50862),v=t(40287),g=t(27218),_=t(91447),f=t(25304);let p={snippets_command_used:{version:1},file_upload_too_large:{version:1},sse_interrupted:{version:1},snippets_suggestion_selected:{version:1},payment_modal_open:{version:1},pro_waitlist_requested:{version:1},payment_state_poll_for_invoice:{version:1},payment_state_poll_for_payment:{version:1},payment_state_poll_for_capability:{version:1},payment_state_payment_requires_confirmation:{version:1},payment_state_payment_failed:{version:1},payment_state_success:{version:1},payment_state_timed_out:{version:1},"onboarding.pubsec_system_use.started":{version:1},"onboarding.phone_verification.start":{version:1},"onboarding.phone_verification.sent_code":{version:1},"onboarding.phone_verification.invalid_code":{version:1},"onboarding.phone_verification.verified_code":{version:1},"onboarding.age_verification.start":{version:1},"onboarding.age_verification.complete":{version:1},"onboarding.name_input.started":{version:1},"onboarding.name_input.finished":{version:1},"onboarding.acceptable_use.started":{version:1},"onboarding.acceptable_use.finished":{version:1},"onboarding.disclaimers.started":{version:1},"onboarding.disclaimers.finished":{version:1},"onboarding.started":{version:1},"onboarding.completed":{version:1},"extended_onboarding.started":{version:1},"extended_onboarding.disclaimer.completed":{version:1},"extended_onboarding.name_input.completed":{version:1},"extended_onboarding.work_function.completed":{version:1},"extended_onboarding.drive_integration.started":{version:1},"extended_onboarding.drive_integration.skipped":{version:1},"extended_onboarding.drive_integration.completed":{version:1},"extended_onboarding.gmail_integration.started":{version:1},"extended_onboarding.gmail_integration.skipped":{version:1},"extended_onboarding.gmail_integration.completed":{version:1},"extended_onboarding.gcal_integration.started":{version:1},"extended_onboarding.gcal_integration.skipped":{version:1},"extended_onboarding.gcal_integration.completed":{version:1},"extended_onboarding.all_integrations.skipped":{version:1},"extended_onboarding.all_integrations.completed":{version:1},"extended_onboarding.topics.completed":{version:1},"extended_onboarding.example_prompts.completed":{version:1},"extended_onboarding.completed":{version:1},"extended_onboarding.hear_about.completed":{version:1},"extended_onboarding.hear_about.source_selected":{version:1},"extended_onboarding.hear_about.skipped":{version:1},"pro_subscription.upgraded_to_annual":{version:1},"pro_subscription.upgraded_to_max":{version:1},"max_subscription.downgraded_to_max":{version:1},"max_subscription.downgraded_to_pro":{version:1},"chat.conversation.first_conversation_created":{version:1},"chat.conversation.too_long_prompt:loaded":{version:1},"chat.conversation.too_long_prompt:accepted":{version:1},"chat.conversation.too_long_prompt:dismissed":{version:1},"chat.conversation.too_long_prompt_warning:loaded":{version:1},"chat.conversation.too_long_prompt_warning:accepted":{version:1},"chat.conversation.too_long_prompt_warning:dismissed":{version:1},"chat.share.button.clicked":{version:1},"chat.share.modal.share_button.clicked":{version:1},"chat.share.modal.unshare_button.clicked":{version:1},"chat.share.open_link.clicked":{version:1},"chat.share.copy_link.clicked":{version:1},"ts.eu_election_banner.shown":{version:1,data_team_tag:"ts"},"ts.banner.shown":{version:1,data_team_tag:"ts"},"billing.credit_card.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.completed":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire_manual.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.completed":{version:1,data_team_tag:"billing_funnel"},"console.feedback.opened":{version:1},"console.feedback.submitted":{version:1},"evals.revision.created":{version:1},"evals.show_prompt_preview.toggled":{version:1},"evals.show_golden_answers.toggled":{version:1},"evals.run_all.submitted":{version:1},"evals.run_all.stopped":{version:1},"evals.test_case.run.submitted":{version:1},"evals.test_case.run.completed":{version:1},"evals.test_case.run.failed":{version:1},"evals.test_case.create.submitted":{version:1},"evals.test_case.delete.submitted":{version:1},"evals.select_revision.clicked":{version:1},"evals.test_case.update_rating.submitted":{version:1},"evals.test_case.import.show_modal.clicked":{version:1},"evals.test_case.import.browse.clicked":{version:1},"evals.test_case.import.success":{version:1},"evals.comparison.add_button.clicked":{version:1},"evals.comparison.remove_button.clicked":{version:1},"evals.comparison.other_revision.selected":{version:1},"test_case_generator.generate.started":{version:1},"test_case_generator.edit_logic.clicked":{version:1},"metaprompter.modal.loaded":{version:2},"metaprompter.example.selected":{version:1},"metaprompter.generate.started":{version:1},"metaprompter.generate.stop.attempted":{version:1},"metaprompter.generate.finished":{version:1},"metaprompter.start_editing.clicked":{version:1},"onboarding.invite_accept_page.invite_accept.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.invite_reject.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.submitted":{version:1,data_team_tag:"onboarding_funnel"},"workbench.prompt.new":{version:1},"workbench.completion.started":{version:2},"workbench.completion.finished":{version:2},"workbench.completion_stream.started":{version:1},"workbench.completion_stream.finished":{version:1},"workbench.tab_selection.clicked":{version:1},"workbench.variables_pane.loaded":{version:1},"workbench.examples.pane.loaded":{version:1},"workbench.examples.example.added":{version:2},"workbench.examples.example.deleted":{version:1},"workbench.examples.converted_to_raw_text":{version:1},"workbench.code_modal.opened":{version:1},"workbench.code_modal.code_copied":{version:1},"claudeai.projects.list_view.switched":{version:1},"claudeai.artifacts.execution.error":{version:1},"claudeai.conversation.suggestion.applied":{version:1},"claudeai.conversation.recent.opened":{version:1},"claudeai.projects.activity.shared_conversation.opened":{version:1},"claudeai.projects.project_starter.clicked":{version:1},"claudeai.projects.chat_starter.clicked":{version:1},"claudeai.conversation.artifact.vscode_exported":{version:1},"claudeai.settings.preview_feature.toggled":{version:1},"claudeai.settings.preview_feature.opened":{version:1},"claudeai.support.opened":{version:1},"claudeai.get_help.clicked":{version:1},"claudeai.conversation.feedback.sent":{version:1},"claudeai.conversation.setting.toggled":{version:1},"claudeai.thinking_cell.clicked":{version:1},"ccos.chatsuggestion.clicked":{version:1},"ccos.chatsuggestions.loaded":{version:1},"ccos.chatsuggestions.feedback":{version:1},"styles.selector.clicked":{version:1},"styles.modal":{version:1},"styles.nux.create_clicked":{version:1},"styles.custom.create_clicked":{version:1},"styles.custom.describe_clicked":{version:1},"styles.custom.describe_selected":{version:1},"styles.selected":{version:1},"artifact.feedback.sentiment":{version:1},"artifact.feedback.note":{version:1},"artifact.share_button_clicked":{version:1},"artifact.publish_button_clicked":{version:1},"artifact.share.modal.share_button_clicked":{version:1},"artifact.publish.modal.publish_button_clicked":{version:1},"artifact.studio.remix":{version:1},"artifact.studio.view_full_chat":{version:1},"artifact.studio.copy_prompt":{version:1},"mcp.servers.listed":{version:1},"mcp.servers.connected":{version:1},"mcp.resources.listed":{version:1},"mcp.resources.read":{version:1},"mcp.prompts.listed":{version:1},"mcp.prompts.used":{version:1},"mcp.tools.listed":{version:1},"mcp.tools.called":{version:1},"mcp.sampling.requested":{version:1},"mcp.websocket.transport.connected":{version:1},"mcp.websocket.authfailure":{version:1},"mcp.websocket.transport.reconnected":{version:1},"harmony.file.saved":{version:1},"harmony.suggestion.accepted":{version:1},"harmony.suggestion.rejected":{version:1},"hfi.comparative_model.selected":{version:1},"hfi.comparative_model.selection_cleared":{version:1},"hfi.comparative_model.streaming.started":{version:1},"hfi.comparative_model.streaming.finished":{version:1},"hfi.comparative_model.feedback_bar.switch_response.clicked":{version:1},"hfi.comparative_model.feedback_bar.prefer_response.clicked":{version:1},"apps.download_button_clicked":{version:1},"apps.nudge_banner_shown":{version:1},"apps.nudge_banner_clicked":{version:1},"apps.harmony_directory_synced":{version:1},"console.onboarding.name_and_legal.loaded":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.name_and_legal.submitted":{version:1,data_team_tag:"onboarding_funnel"},"tengu.waitlist.update":{version:1},"tengu.waitlist.details":{version:1},"oauth.authorize.approved":{version:1},"oauth.authorize.denied":{version:1},"oauth.authorize.success":{version:1},"oauth.authorize.failure":{version:1},"console.onboarding.account_type.loaded":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.account_type.individual_selected":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.account_type.organization_selected":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.organization_details.loaded":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.organization_details.submitted":{version:1,data_team_tag:"onboarding_funnel"},"login.account.created":{version:1},"login.email.sending_magic_link":{version:1},"login.email.magic_link_sent":{version:1},"login.email.magic_link_send_error":{version:1},"login.email.verifying_magic_link":{version:1},"login.email.magic_link_success":{version:1},"login.email.magic_link_verification_error":{version:1},"login.email.sso_initiated":{version:1},"login.email.sso_success":{version:1},"login.email.sso_verifying_callback":{version:1},"login.email.sso_verification_error":{version:1},"login.email.verifying_code":{version:1},"login.email.code_verification_error":{version:1},"login.email.finished":{version:1},"login.google.started":{version:1},"login.google.error":{version:1},"login.google.verifying":{version:1},"login.google.verification_error":{version:1},"login.google.finished":{version:1},"landing.section.features.viewed":{version:1},"landing.section.pricing.viewed":{version:1},"spotlight.shown":{version:1},"spotlight.dismissed":{version:1},"spotlight.action_clicked":{version:1},"claudeai.conversation.citation_clicked":{version:1},"claudeai.in_chat_upsell.connect_gdrive.start":{version:1},"claudeai.in_chat_upsell.dismiss":{version:1},"claudeai.cardamom_prompts.category_displayed":{version:1},"claudeai.cardamom_prompts.prompt_displayed":{version:1},"claudeai.cardamom_prompts.prompt_used":{version:1},"artifactinlinefeedback.selection.clicked":{version:1},"claudeai.toast.shown":{version:1},"claudeai.toast.dismissed":{version:1},"claudeai.toast.cta_clicked":{version:1},"claudeai.invite_contest.clicked":{version:1},"claudeai.invite_contest.dismissed":{version:1},"claudeai.notification.permission.request_started":{version:1},"claudeai.notification.permission.result":{version:1}},m=()=>{let{analytics:e}=(0,_.K)(),n=(0,f.T)(),{preferences:t}=(0,d.C)(),r=(0,v.f)(),{value:a}=(0,o.FL)("log_segment_events"),u=(0,l.$)(),{value:m}=(0,o.FL)("send_email_to_segment"),{account:h,activeOrganization:b,isLoading:y}=(0,g.t)(),k=(0,c.Zx)(),C=null==h?void 0:h.uuid,w=null==b?void 0:b.uuid,x=null==b?void 0:b.billing_type,E=null==h?void 0:h.email_address,S=(0,s.useCallback)(n=>{let r=!n&&!h;return!y&&e&&u&&(!r||t.analytics)},[y,e,u,h,t.analytics]),T=(0,s.useCallback)(async(t,o)=>{var s,l,u,c;let{event_key:d,...v}=t,g={account_uuid:null!==(u=null==o?void 0:o.uuid)&&void 0!==u?u:C,organization_uuid:w,billing_type:x,surface:k?"claude-ai":"console",...p[d],...v},_={context:{traits:{email:m?null!==(c=null==o?void 0:o.email_address)&&void 0!==c?c:E:null,userAgent:null===(l=window)||void 0===l?void 0:null===(s=l.navigator)||void 0===s?void 0:s.userAgent,fbc:r.get(i.cn.FBCLID),gclid:r.get(i.cn.GOOGLE_GCL_AW)}}};a&&console.log("[Segment Event] track: ".concat(d),g,_),S(o)&&(await (null==e?void 0:e.track(d,g,_)),null==n||n.track(d,g,_))},[e,n,r,C,w,x,E,k,a,m,S]),O=(0,s.useCallback)(async(t,r)=>{a&&console.log("[Segment Event] identify: ".concat(t),r),S()&&(await (null==e?void 0:e.identify(t,r)),null==n||n.identify(t,r))},[e,n,S,a]),I=(0,s.useCallback)(async(n,t)=>{var r,i,o;a&&console.log("[Segment Event] page_view: ".concat(n),t),S()&&(null!==(i=null===(r=await (null==e?void 0:e.user()))||void 0===r?void 0:r.id())&&void 0!==i?i:void 0)===(null!==(o=null==h?void 0:h.uuid)&&void 0!==o?o:void 0)&&await (null==e?void 0:e.page(n,t))},[e,S,h,a]);return(0,s.useMemo)(()=>({track:T,identify:O,page:I}),[T,O,I])},h=(e,n,t,i)=>{let o=m(),{onSuccess:a,onError:s,...l}=i||{};return(0,u.uC)(n,t,{onSuccess(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];o.track({event_key:e,result:"success"}),null==a||a(...t)},onError(n){let t;for(var i=arguments.length,a=Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];n instanceof r.Hx&&(t=n.type),o.track({event_key:e,result:"failure",failure_reason:t}),null==s||s(n,...a)},...l})},b=e=>{var n;let{eventKey:t,threshold:r=.5,freezeOnceVisible:i=!0}=e,{track:o}=m(),l=(0,s.useRef)(!1),{ref:u,entry:c}=(0,a.s)({threshold:r}),d=null!==(n=null==c?void 0:c.isIntersecting)&&void 0!==n&&n;return(0,s.useEffect)(()=>{!d||i&&l.current||(o({event_key:t}),l.current=!0)},[d,o,t,i]),u}},50862:function(e,n,t){"use strict";t.d(n,{ConsentProvider:function(){return _},C:function(){return f}});var r=t(27573),i=t(45144),o=t(7653),a=t(40287),s=t(94872),l=t(53500),u=t(6385),c=t(35919),d=t.n(c),v=t(95407);let g=(0,o.createContext)({showConsentBanner:!1,openConsentBanner:d(),preferences:v.iw,savePreferences:d()}),_=e=>{let{children:n,requiresExplicitConsent:t}=e,[c,d,_]=function(e,n){let t=(0,a.f)(),[r,s]=(0,o.useState)(()=>!!t.get(e)),[l,u]=(0,o.useState)(()=>{try{let r=t.get(e);return r?JSON.parse(r):n}catch(t){return(0,i.Tb)(t,{extra:{message:"Malformed JSON cookie",cookieKey:e}}),n}});return[l,(0,o.useCallback)(n=>{t.set(e,JSON.stringify(n)),u(n),s(!0)},[t,e]),r]}(u.cn.CONSENT_PREFERENCES,t?v.iw:v.DF),[f,p]=(0,o.useState)(t&&!_),m=(0,o.useCallback)(e=>{d(e),(0,s.HF)(e),p(!1),l.u.updateCategories(e)},[d,p]);return(0,r.jsx)(g.Provider,{value:{showConsentBanner:f,openConsentBanner:()=>p(!0),preferences:c,savePreferences:m},children:n})};function f(){return(0,o.useContext)(g)}},1812:function(e,n,t){"use strict";t.d(n,{I:function(){return s},T:function(){return a}});var r=t(27573),i=t(7653);let o=(0,i.createContext)(null),a=()=>{let e=(0,i.useContext)(o);return void 0===e?null:e},s=e=>{let{children:n,settings:t}=e;return(0,r.jsx)(o.Provider,{value:t,children:n})}},27895:function(e,n,t){"use strict";t.d(n,{ErrorsProvider:function(){return h},e:function(){return b},v:function(){return C}});var r=t(27573),i=t(35228),o=t(87033),a=t(97975),s=t.n(a),l=t(55854),u=t.n(l),c=t(78646),d=t.n(c),v=t(81695),g=t(7653),_=t(41270),f=t(27218),p=t(18013);let m=(0,g.createContext)(void 0);function h(e){let{children:n}=e,t=(0,g.useRef)(1),[i,o]=(0,g.useState)([]),a=(0,g.useCallback)(e=>{o(n=>n.filter(n=>n.id!==e))},[]),s=(0,g.useCallback)((e,n)=>{let r=t.current++;return o(n=>[...n,{id:r,message:e instanceof Error?e.message:e,toastType:"error"}]),n&&setTimeout(()=>a(r),n),r},[a]),l=(0,g.useCallback)((e,n)=>{let r=t.current++;return o(n=>[...n,{id:r,message:e,toastType:"success"}]),n&&setTimeout(()=>a(r),n),r},[a]),u=(0,g.useMemo)(()=>({toasts:i,addError:s,addSuccess:l,clearToast:a}),[i,s,l,a]);return(0,r.jsx)(m.Provider,{value:u,children:n})}function b(){let e=(0,g.useContext)(m);if(!e)throw Error("Must be called within ErrorsProvider");return e}let y=_.z.object({id:_.z.string().optional().nullable(),title:_.z.string().optional().nullable(),message:_.z.string().optional().nullable(),displayFrequencyHours:_.z.number().optional().nullable()}),k={};function C(){var e;let{id:n,title:t,message:r,displayFrequencyHours:a}=(0,o.xQ)("claude_system_message",k,y),{account:l}=(0,f.t)(),c=null!==(e=null==l?void 0:l.uuid)&&void 0!==e?e:"logged-out",_=(0,v.usePathname)(),[m,h]=(0,p.R)("dismissed-system-messages",{}),b=(0,g.useMemo)(()=>()=>h(e=>{let t=s()(e);return n&&d()(t,[c,n],Date.now()),t}),[h,c,n]);return(0,g.useMemo)(()=>{if(!l||(0,i.cG)(l,!0)||"/download"===_||!n)return!1;let e=u()(m,[c,n]);return!e||"boolean"==typeof e||!!a&&Date.now()-e>=36e5*a},[l,n,c,m,a,_])?{currentSystemMessageId:n,currentSystemMessageTitle:t,currentSystemMessageContent:r,dismissCurrentSystemMessage:b}:{currentSystemMessageId:null,currentSystemMessageTitle:null,currentSystemMessageContent:null,dismissCurrentSystemMessage:()=>null}}},94872:function(e,n,t){"use strict";t.d(n,{HF:function(){return o},bq:function(){return i}});var r=t(45144);let i=function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];try{"function"==typeof window.gtag&&gtag(e,...t)}catch(e){(0,r.Tb)(e)}},o=e=>{i("consent","update",a(e))},a=e=>({ad_personalization:e.marketing?"granted":"denied",ad_user_data:e.marketing?"granted":"denied",ad_storage:e.marketing?"granted":"denied",analytics_storage:e.analytics?"granted":"denied",functionality_storage:"granted",personalization_storage:"granted",security_storage:"granted"})},91447:function(e,n,t){"use strict";t.d(n,{K:function(){return s}});var r=t(8571),i=t(87033),o=t(7653),a=t(53500);let s=()=>{let{segmentKey:e,segmentCdnHost:n,segmentApiHost:t}=(0,r.mX)(),{value:s}=(0,i.FL)("requires_explicit_consent"),l=(0,o.useCallback)(()=>{a.u.reset()},[]);return{analytics:a.u.loadIfNecessary({segmentKey:e,segmentCdnHost:n,segmentApiHost:t,requiresExplicitConsent:s}),reset:l}}},25304:function(e,n,t){"use strict";t.d(n,{IsolatedSegmentProvider:function(){return v},T:function(){return g}});var r=t(27573),i=t(80573),o=t(8571),a=t(87033),s=t(44053),l=t(7653);let u=["onboarding.started","extended_onboarding.started","onboarding.completed","chat.conversation.first_conversation_created","payment_state_success"],c={"onboarding.started":"Onboarding Started","extended_onboarding.started":"Onboarding Started","onboarding.completed":"Onboarding Completed","chat.conversation.first_conversation_created":"First Conversation Started",payment_state_success:"Purchase"},d=(0,l.createContext)(null);function v(e){let{children:n}=e,{segmentKey:t,segmentCdnHost:v}=(0,o.mX)(),g=(0,l.useRef)(null),[_,f]=(0,l.useState)(!1),p=(0,l.useRef)([]),{value:m}=(0,a.FL)("log_segment_events"),h=m&&!0,b=(0,i.$)(),y=(0,l.useCallback)(function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];h&&console.log("[IsolatedSegmentProvider]",e,...t)},[h]),k=(0,l.useCallback)(()=>{let e=[...p.current];p.current=[],e.forEach(e=>{var n,t;y("Sending message to iframe:",e,p.current),null===(t=g.current)||void 0===t||null===(n=t.contentWindow)||void 0===n||n.postMessage({target:"isolated-segment",...e},"*")})},[y]),C=(0,l.useCallback)(e=>{var n;p.current.push(e),(null===(n=g.current)||void 0===n?void 0:n.contentWindow)&&(_||"init"===e.type)?k():y("iframe not ready, queueing message:",e)},[y,_,k]);(0,s.s)("message",(0,l.useCallback)(e=>{let n=e.data;if("isolated-segment"===n.source)switch(y("Received message from iframe:",n),n.type){case"iframe_ready":y("Iframe ready, initializing Segment with writeKey:",t,"cdnHost:",v),C({type:"init",writeKey:t,cdnHost:v});break;case"segment_initialized":y("Segment in iframe initialized successfully"),f(!0),y("messageQueue when IsolatedSegment is ready",p.current),k(),p.current=[];break;default:y("Message from isolated-segment iframe:",n.type)}},[v,t,y,C,f,k]));let w=(0,l.useCallback)((e,n,t)=>{if(y("Tracking event:",e,n,t),u.includes(e)){let r=c[e]||e;y("Sending event to Facebook Pixel:",e,r,n),C({type:"track",event:r,properties:n,options:t})}},[y,C]),x=(0,l.useCallback)((e,n)=>{y("Identifying user:",e,n),C({type:"identify",userId:e,traits:n})},[y,C]),E=(0,l.useCallback)(()=>{y("Sending ping..."),C({type:"ping"})},[y,C]),S=(0,l.useMemo)(()=>({isReady:_,track:w,identify:x,sendPing:E}),[_,w,x,E]);return(0,r.jsxs)(d.Provider,{value:S,children:[n,b&&(0,r.jsx)("iframe",{ref:g,src:"/isolated-segment.html",style:{display:"none"},referrerPolicy:"no-referrer",sandbox:"allow-scripts allow-same-origin",title:""})]})}function g(){return(0,l.useContext)(d)}},48410:function(e,n,t){"use strict";t.d(n,{TierSelectorProvider:function(){return d},i:function(){return c}});var r=t(27573),i=t(6385),o=t(87033),a=t(98649),s=t(7653),l=t(40287);let u=(0,s.createContext)(null),c=()=>{let e=(0,s.useContext)(u);if(!e)throw Error("useTierSelector must be used within a TierSelectorProvider");return e},d=e=>{var n;let{children:t,initialEnabled:c=!1}=e,d=(0,l.f)(),[v,g]=(0,s.useState)(()=>d.get(i.cn.SELECTED_TIER)||null),[_,f]=(0,s.useState)(()=>"true"===d.get(i.cn.SHOULD_OVERRIDE_TOKEN_LIMITS)),[p,m]=(0,s.useState)(()=>"true"===d.get(i.cn.SHOULD_OVERRIDE_FEATURE_ACCESS)),h=null!==(n=(0,o.FL)("internal_tier_selector").value)&&void 0!==n?n:c,b=(0,s.useState)(h)[1],y=(0,s.useCallback)(()=>{let e=[a.kQ.FREE,a.kQ.PRO,a.kQ.ENTERPRISE,a.kQ.MAX],n=Math.floor(Math.random()*e.length);return e[n]},[]),k=(0,s.useCallback)(e=>{if(!h){g(e);return}if(null===e){let e=v||y();d.set(i.cn.SELECTED_TIER,e,{maxAgeSeconds:2592e3})}else d.set(i.cn.SELECTED_TIER,e);g(e)},[v,g,d,y,h]);(0,s.useEffect)(()=>{h?v&&d.set(i.cn.SELECTED_TIER,v):d.delete(i.cn.SELECTED_TIER)},[h,v,d]);let C=(0,s.useCallback)(e=>{if(!h){f(e);return}e?d.set(i.cn.SHOULD_OVERRIDE_TOKEN_LIMITS,"true"):d.delete(i.cn.SHOULD_OVERRIDE_TOKEN_LIMITS),f(e)},[h,d]),w=(0,s.useCallback)(e=>{if(!h){m(e);return}e?d.set(i.cn.SHOULD_OVERRIDE_FEATURE_ACCESS,"true"):d.delete(i.cn.SHOULD_OVERRIDE_FEATURE_ACCESS),m(e)},[h,d]);return(0,s.useEffect)(()=>{h||(d.delete(i.cn.SHOULD_OVERRIDE_TOKEN_LIMITS),d.delete(i.cn.SHOULD_OVERRIDE_FEATURE_ACCESS))},[h,d]),(0,r.jsx)(u.Provider,{value:{selectedTier:v,isTierSelectorEnabled:h,setSelectedTier:k,setIsTierSelectorEnabled:b,shouldOverrideTokenLimits:_,setShouldOverrideTokenLimits:C,shouldOverrideFeatureAccess:p,setShouldOverrideFeatureAccess:w},children:t})}},18013:function(e,n,t){"use strict";t.d(n,{A:function(){return o},R:function(){return a}});var r=t(83981),i=t(14418);function o(e,n){return(0,r.X)({key:"SSS-".concat(e),defaultValue:n,serialize:JSON.stringify,deserialize:e=>void 0===e?n:JSON.parse(e)})}function a(e,n){return(0,i.I)({key:"LSS-".concat(e),defaultValue:n,serialize:JSON.stringify,deserialize:e=>void 0===e?n:JSON.parse(e),getInitialValueInEffect:!1,sync:!0})}},35228:function(e,n,t){"use strict";t.d(n,{D_:function(){return a},IC:function(){return s},c6:function(){return i},cG:function(){return l},kK:function(){return o},wJ:function(){return r}});let r=e=>{let{account:n,isClaudeDot:t}=e;return t?!1===n.settings.has_finished_claudeai_onboarding:!n.full_name||!n.display_name},i=(e,n)=>n&&!e.is_verified,o=(e,n)=>!!function(e,n){for(let t of e.invites)if(t.organization.capabilities&&t.organization.capabilities.includes(n))return t}(e,n?"raven":"api"),a=(e,n)=>!n&&0===e.invites.length&&0===e.memberships.filter(e=>e.organization.capabilities.includes("api")).length,s=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t&&n&&!e.age_is_verified},l=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r({account:e,isClaudeDot:n})||i(e,n)||o(e,n)||a(e,n)||s(e,n,t)}},66894:function(e,n,t){"use strict";t.d(n,{Ry:function(){return o},yG:function(){return r}}),t(68571);let r=()=>!1,i=()=>!1,o=()=>i()||r()},98731:function(e,n,t){"use strict";t.d(n,{K:function(){return r}});let r=e=>{let n="";if(e.content)for(let t of e.content)"text"===t.type&&(n+=t.text);return n}},51432:function(e,n,t){"use strict";t.d(n,{H:function(){return r}});let r=()=>void 0===crypto.randomUUID?"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,e=>{let n=parseInt(e);return(n^crypto.getRandomValues(new Uint8Array(1))[0]&15>>n/4).toString(16)}):crypto.randomUUID()},58884:function(e,n,t){"use strict";async function r(e,n){let t;let r=e.getReader();for(;!(t=await r.read()).done;)n(t.value)}function i(){return{data:"",event:"",id:"",retry:void 0}}t.d(n,{a:function(){return a},L:function(){return l}});var o=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>n.indexOf(r)&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>n.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};let a="text/event-stream",s="last-event-id";function l(e,n){var{signal:t,headers:l,onopen:c,onmessage:d,onclose:v,onerror:g,openWhenHidden:_,fetch:f}=n,p=o(n,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((n,o)=>{let m;let h=Object.assign({},l);function b(){m.abort(),document.hidden||E()}h.accept||(h.accept=a),"undefined"==typeof document||_||document.addEventListener("visibilitychange",b);let y=1e3,k=0;function C(){"undefined"==typeof document||_||document.removeEventListener("visibilitychange",b),clearTimeout(k),m.abort()}null==t||t.addEventListener("abort",()=>{C(),n()});let w=null!=f?f:fetch,x=null!=c?c:u;async function E(){var t,a;m=new AbortController;try{let t,o,l,u;let c=await w(e,Object.assign(Object.assign({},p),{headers:h,signal:m.signal}));await x(c),await r(c.body,(a=function(e,n,t){let r=i(),o=new TextDecoder;return function(a,s){if(0===a.length)null==e||e(r),r=i();else if(s>0){let e=o.decode(a.subarray(0,s)),i=s+(32===a[s+1]?2:1),l=o.decode(a.subarray(i));switch(e){case"data":r.data=r.data?r.data+"\n"+l:l;break;case"event":r.event=l;break;case"id":null==n||n(r.id=l);break;case"retry":let u=parseInt(l,10);isNaN(u)||null==t||t(r.retry=u)}}}}(d,e=>{e?h[s]=e:delete h[s]},e=>{y=e}),u=!1,function(e){void 0===t?(t=e,o=0,l=-1):t=function(e,n){let t=new Uint8Array(e.length+n.length);return t.set(e),t.set(n,e.length),t}(t,e);let n=t.length,r=0;for(;o<n;){u&&(10===t[o]&&(r=++o),u=!1);let e=-1;for(;o<n&&-1===e;++o)switch(t[o]){case 58:-1===l&&(l=o-r);break;case 13:u=!0;case 10:e=o}if(-1===e)break;a(t.subarray(r,e),l),r=o,l=-1}r===n?t=void 0:0!==r&&(t=t.subarray(r),o-=r)})),null==v||v(),C(),n()}catch(e){if(!m.signal.aborted)try{let n=null!==(t=null==g?void 0:g(e))&&void 0!==t?t:y;clearTimeout(k),k=setTimeout(E,n)}catch(e){C(),o(e)}}}E()})}function u(e){let n=e.headers.get("content-type");if(!(null==n?void 0:n.startsWith(a)))throw Error(`Expected content-type to be ${a}, Actual: ${n}`)}},99586:function(e,n,t){"use strict";t.d(n,{s:function(){return i}});var r=t(7653);function i(e){let[n,t]=(0,r.useState)(null),i=(0,r.useRef)(null);return{ref:(0,r.useCallback)(n=>{if(i.current&&(i.current.disconnect(),i.current=null),null===n){t(null);return}i.current=new IntersectionObserver(e=>{let[n]=e;t(n)},e),i.current.observe(n)},[null==e?void 0:e.rootMargin,null==e?void 0:e.root,null==e?void 0:e.threshold]),entry:n}}}},function(e){e.O(0,[950,3279,6340,1270,8183,6947,3840,6971,7492,3290,7218,1817,1293,1362,4856,1744],function(){return e(e.s=91192)}),_N_E=e.O()}]);